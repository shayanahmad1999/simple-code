<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Password Generator</title>
    <style>
        :root {
            --bg1: #6a11cb;
            --bg2: #2575fc;
            --card: #ffffff;
            --text: #222;
            --muted: #666;
            --accent: #2575fc;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
            background: linear-gradient(135deg, var(--bg1), var(--bg2));
            color: var(--text);
        }

        .container {
            width: 100%;
            max-width: 560px;
            background: var(--card);
            border-radius: 14px;
            padding: 22px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .18);
        }

        h1 {
            font-size: 1.2rem;
            margin: 0 0 14px;
        }

        .row {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            margin-bottom: 14px;
        }

        #password {
            grid-column: 1 / -1;
            font: 600 1.1rem/1.2 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
            background: #f4f6fb;
            border: 1px solid #e6e8f0;
            border-radius: 8px;
            padding: 12px;
            word-break: break-all;
            min-height: 48px;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .control {
            background: #f8f9ff;
            border: 1px solid #e6e8f9;
            border-radius: 10px;
            padding: 10px 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            width: 100%;
        }

        .muted {
            color: var(--muted);
            font-size: .9rem;
        }

        input[type="number"] {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #d8def0;
            border-radius: 8px;
            font-size: 0.95rem;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 6px;
        }

        button {
            appearance: none;
            border: 0;
            border-radius: 10px;
            padding: 10px 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform .03s ease, box-shadow .2s ease, background .2s ease;
        }

        .btn-primary {
            background: var(--accent);
            color: #fff;
            box-shadow: 0 6px 14px rgba(37, 117, 252, .3);
        }

        .btn-primary:hover {
            filter: brightness(0.95);
        }

        .btn-ghost {
            background: #eef3ff;
            color: #1b3a8a;
        }

        .error {
            color: #b00020;
            font-size: 0.92rem;
            margin-top: 8px;
        }

        .hint {
            font-size: .88rem;
            color: var(--muted);
            margin-top: 6px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Password Generator</h1>

        <div class="row">
            <div id="password" aria-live="polite"></div>
        </div>

        <div class="controls">
            <div class="control" title="How many characters long?">
                <label>
                    <span>Length</span>
                    <input id="length" type="number" min="4" max="128" value="12" />
                </label>
            </div>

            <div class="control">
                <label><input id="lower" type="checkbox" checked /> Lowercase (a-z)</label>
            </div>
            <div class="control">
                <label><input id="upper" type="checkbox" checked /> Uppercase (A-Z)</label>
            </div>
            <div class="control">
                <label><input id="number" type="checkbox" checked /> Numbers (0-9)</label>
            </div>
            <div class="control">
                <label><input id="symbol" type="checkbox" /> Symbols (!@#$…)</label>
            </div>
        </div>

        <div class="actions">
            <button class="btn-primary" id="generateBtn">Generate Password</button>
            <button class="btn-ghost" id="copyBtn">Copy</button>
        </div>

        <div id="error" class="error" role="alert" style="display:none;"></div>
        <div class="hint">Tip: include at least two character types for better strength.</div>
    </div>

    <script>
        // Character sets
        const SETS = {
            lower: "abcdefghijklmnopqrstuvwxyz",
            upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
            number: "0123456789",
            symbol: `!@#$%^&*()-_=+[]{};:,.<>?/|~`
        };

        const passwordEl = document.getElementById("password");
        const lenEl = document.getElementById("length");
        const lowerEl = document.getElementById("lower");
        const upperEl = document.getElementById("upper");
        const numberEl = document.getElementById("number");
        const symbolEl = document.getElementById("symbol");
        const errorEl = document.getElementById("error");
        const genBtn = document.getElementById("generateBtn");
        const copyBtn = document.getElementById("copyBtn");

        // Secure random integer [0, max)
        function randInt(max) {
            if (max <= 0) return 0;
            const buf = new Uint32Array(1);
            window.crypto.getRandomValues(buf);
            return buf[0] % max;
        }

        // Shuffle array in place (Fisher–Yates) with crypto randomness
        function shuffle(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = randInt(i + 1);
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function generatePassword() {
            errorEl.style.display = "none";
            const length = Math.max(4, Math.min(128, Number(lenEl.value) || 12));

            const activeSets = [];
            if (lowerEl.checked) activeSets.push("lower");
            if (upperEl.checked) activeSets.push("upper");
            if (numberEl.checked) activeSets.push("number");
            if (symbolEl.checked) activeSets.push("symbol");

            if (activeSets.length === 0) {
                showError("Please select at least one character type.");
                return "";
            }

            if (length < activeSets.length) {
                showError(`Length must be at least ${activeSets.length} to include all selected types.`);
                return "";
            }

            // Ensure at least one character from each selected set
            const mandatory = activeSets.map(key => {
                const s = SETS[key];
                return s[randInt(s.length)];
            });

            // Build the full pool
            const pool = activeSets.map(k => SETS[k]).join("");

            const rest = [];
            for (let i = 0; i < length - mandatory.length; i++) {
                rest.push(pool[randInt(pool.length)]);
            }

            // Combine and shuffle for randomness
            const chars = shuffle(mandatory.concat(rest));
            return chars.join("");
        }

        function showError(msg) {
            errorEl.textContent = msg;
            errorEl.style.display = "block";
        }

        genBtn.addEventListener("click", () => {
            const pwd = generatePassword();
            if (pwd) passwordEl.textContent = pwd;
        });

        copyBtn.addEventListener("click", async () => {
            const text = passwordEl.textContent.trim();
            if (!text) return;
            try {
                await navigator.clipboard.writeText(text);
                copyBtn.textContent = "Copied!";
                setTimeout(() => (copyBtn.textContent = "Copy"), 1000);
            } catch {
                showError("Could not copy to clipboard. Copy manually.");
            }
        });

        // Generate one on load
        passwordEl.textContent = generatePassword();
    </script>
</body>

</html>